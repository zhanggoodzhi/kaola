/**!
 * AngularJS file upload directives and services. Supoorts: file upload/drop/paste, resume, cancel/abort,
 * progress, resize, thumbnail, preview, validation and CORS
 * FileAPI Flash shim for old browsers not supporting FormData
 * @author  Danial  <danial.farid@gmail.com>
 * @version 12.0.4
 */'use strict';(function(){function h(e,c){window.XMLHttpRequest.prototype[e]=c(window.XMLHttpRequest.prototype[e])}function l(e,c,b){try{Object.defineProperty(e,c,{get:b})}catch(d){}}window.FileAPI||(window.FileAPI={});if(!window.XMLHttpRequest)throw"AJAX is not supported. XMLHttpRequest is not defined.";FileAPI.shouldLoad=!window.FormData||FileAPI.forceLoad;if(FileAPI.shouldLoad){var g=function(e){if(!e.__listeners){e.upload||(e.upload={});e.__listeners=[];var c=e.upload.addEventListener;e.upload.addEventListener=function(b,d){e.__listeners[b]=d;c&&c.apply(this,arguments)}}};h("open",function(e){return function(c,b,d){g(this);this.__url=b;try{e.apply(this,[c,b,d])}catch(a){-1<a.message.indexOf("Access is denied")&&(this.__origError=a,e.apply(this,[c,"_fix_for_ie_crossdomain__",d]))}}});h("getResponseHeader",function(e){return function(c){return this.__fileApiXHR&&this.__fileApiXHR.getResponseHeader?this.__fileApiXHR.getResponseHeader(c):null==e?null:e.apply(this,[c])}});h("getAllResponseHeaders",function(e){return function(){return this.__fileApiXHR&&this.__fileApiXHR.getAllResponseHeaders?this.__fileApiXHR.getAllResponseHeaders():null==e?null:e.apply(this)}});h("abort",function(e){return function(){return this.__fileApiXHR&&this.__fileApiXHR.abort?this.__fileApiXHR.abort():null==e?null:e.apply(this)}});h("setRequestHeader",function(e){return function(c,b){if("__setXHR_"===c){g(this);var d=b(this);d instanceof Function&&d(this)}else this.__requestHeaders=this.__requestHeaders||{},this.__requestHeaders[c]=b,e.apply(this,arguments)}});h("send",function(e){return function(){var c=this;if(arguments[0]&&arguments[0].__isFileAPIShim){for(var b=arguments[0],d={url:c.__url,jsonp:!1,cache:!0,complete:function(a,b){a&&angular.isString(a)&&-1!==a.indexOf("#2174")&&(a=null);c.__completed=!0;!a&&c.__listeners.load&&c.__listeners.load({type:"load",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0});!a&&c.__listeners.loadend&&c.__listeners.loadend({type:"loadend",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0});"abort"===a&&c.__listeners.abort&&c.__listeners.abort({type:"abort",loaded:c.__loaded,total:c.__total,target:c,lengthComputable:!0});void 0!==b.status&&l(c,"status",function(){return 0===b.status&&a&&"abort"!==a?500:b.status});void 0!==b.statusText&&l(c,"statusText",function(){return b.statusText});l(c,"readyState",function(){return 4});void 0!==b.response&&l(c,"response",function(){return b.response});var k=b.responseText||(a&&0===b.status&&"abort"!==a?a:void 0);l(c,"responseText",function(){return k});l(c,"response",function(){return k});a&&l(c,"err",function(){return a});c.__fileApiXHR=b;if(c.onreadystatechange)c.onreadystatechange();if(c.onload)c.onload()},progress:function(a){a.target=c;c.__listeners.progress&&c.__listeners.progress(a);c.__total=a.total;c.__loaded=a.loaded;if(a.total===a.loaded){var b=this;setTimeout(function(){c.__completed||(c.getAllResponseHeaders=function(){},b.complete(null,{status:204,statusText:"No Content"}))},FileAPI.noContentTimeout||1E4)}},headers:c.__requestHeaders,data:{},files:{}},a=0;a<b.data.length;a++){var f=b.data[a];null!=f.val&&null!=f.val.name&&null!=f.val.size&&null!=f.val.type?d.files[f.key]=f.val:d.data[f.key]=f.val}setTimeout(function(){if(!FileAPI.hasFlash)throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';c.__fileApiXHR=FileAPI.upload(d)},1)}else{if(this.__origError)throw this.__origError;e.apply(c,arguments)}}});window.XMLHttpRequest.__isFileAPIShim=!0;window.FormData=FormData=function(){return{append:function(e,c,b){c.__isFileAPIBlobShim&&(c=c.data[0]);this.data.push({key:e,val:c,name:b})},data:[],__isFileAPIShim:!0}};window.Blob=Blob=function(e){return{data:e,__isFileAPIBlobShim:!0}}}})();(function(){function h(a){return"input"===a[0].tagName.toLowerCase()&&a.attr("type")&&"file"===a.attr("type").toLowerCase()}function l(){try{return new ActiveXObject("ShockwaveFlash.ShockwaveFlash"),!0}catch(m){if(void 0!==navigator.mimeTypes["application/x-shockwave-flash"])return!0}return!1}function g(a){var b=0,c=0;if(window.jQuery)return jQuery(a).offset();if(a.offsetParent){do b+=a.offsetLeft-a.scrollLeft,c+=a.offsetTop-a.scrollTop,a=a.offsetParent;while(a)}return{left:b,top:c}}if(FileAPI.shouldLoad){FileAPI.hasFlash=l();FileAPI.forceLoad&&(FileAPI.html5=!1);if(!FileAPI.upload){var e,c,b=document.createElement("script"),d=document.getElementsByTagName("script"),a,f,k;if(window.FileAPI.jsUrl)e=window.FileAPI.jsUrl;else if(window.FileAPI.jsPath)c=window.FileAPI.jsPath;else for(a=0;a<d.length;a++)if(k=d[a].src,f=k.search(/\/ng\-file\-upload[\-a-zA-z0-9\.]*\.js/),-1<f){c=k.substring(0,f+1);break}null==FileAPI.staticPath&&(FileAPI.staticPath=c);b.setAttribute("src",e||c+"FileAPI.min.js");document.getElementsByTagName("head")[0].appendChild(b)}FileAPI.ngfFixIE=function(a,b,c){if(!l())throw'Adode Flash Player need to be installed. To check ahead use "FileAPI.hasFlash"';a.bind("mouseenter",function(){var f=b.parent();a.attr("disabled")?f&&f.removeClass("js-fileapi-wrapper"):(b.attr("__ngf_flash_")||(b.unbind("change"),b.unbind("click"),b.bind("change",function(a){k.apply(this,[a]);c.apply(this,[a])}),b.attr("__ngf_flash_","true")),f.addClass("js-fileapi-wrapper"),h(a)||(f.css("position","absolute").css("top",g(a[0]).top+"px").css("left",g(a[0]).left+"px").css("width",a[0].offsetWidth+"px").css("height",a[0].offsetHeight+"px").css("filter","alpha(opacity\x3d0)").css("display",a.css("display")).css("overflow","hidden").css("z-index","900000").css("visibility","visible"),b.css("width",a[0].offsetWidth+"px").css("height",a[0].offsetHeight+"px").css("position","absolute").css("top","0px").css("left","0px")))});var k=function(a){for(var b=FileAPI.getFiles(a),c=0;c<b.length;c++)void 0===b[c].size&&(b[c].size=0),void 0===b[c].name&&(b[c].name="file"),void 0===b[c].type&&(b[c].type="undefined");a.target||(a.target={});a.target.files=b;a.target.files!==b&&(a.__files_=b);(a.__files_||a.target.files).item=function(b){return(a.__files_||a.target.files)[b]||null}}};FileAPI.disableFileInput=function(a,b){b?a.removeClass("js-fileapi-wrapper"):a.addClass("js-fileapi-wrapper")}}})();window.FileReader||(window.FileReader=function(){var h=this,l=!1;this.listeners={};this.addEventListener=function(c,b){h.listeners[c]=h.listeners[c]||[];h.listeners[c].push(b)};this.removeEventListener=function(c,b){h.listeners[c]&&h.listeners[c].splice(h.listeners[c].indexOf(b),1)};this.dispatchEvent=function(c){var b=h.listeners[c.type];if(b)for(var d=0;d<b.length;d++)b[d].call(h,c)};this.onabort=this.onerror=this.onload=this.onloadstart=this.onloadend=this.onprogress=null;var g=function(c,b){c={type:c,target:h,loaded:b.loaded,total:b.total,error:b.error};null!=b.result&&(c.target.result=b.result);return c},e=function(c){if(!l&&(l=!0,h.onloadstart))h.onloadstart(g("loadstart",c));if("load"===c.type){if(h.onloadend)h.onloadend(g("loadend",c));c=g("load",c);if(h.onload)h.onload(c)}else if("progress"===c.type){if(c=g("progress",c),h.onprogress)h.onprogress(c)}else if(c=g("error",c),h.onerror)h.onerror(c);h.dispatchEvent(c)};this.readAsDataURL=function(c){FileAPI.readAsDataURL(c,e)};this.readAsText=function(c){FileAPI.readAsText(c,e)}});!window.XMLHttpRequest||window.FileAPI&&FileAPI.shouldLoad||(window.XMLHttpRequest.prototype.setRequestHeader=function(h){return function(l,g){if("__setXHR_"===l){var e=g(this);e instanceof Function&&e(this)}else h.apply(this,arguments)}}(window.XMLHttpRequest.prototype.setRequestHeader));var ngFileUpload=angular.module("ngFileUpload",[]);ngFileUpload.version="12.0.4";ngFileUpload.service("UploadBase",["$http","$q","$timeout",function(h,l,g){function e(a){function c(a){n.notify&&n.notify(a);p.progressFunc&&g(function(){p.progressFunc(a)})}function k(b){return null!=a._start&&d?{loaded:b.loaded+a._start,total:a._file&&a._file.size||b.total,type:b.type,config:a,lengthComputable:!0,target:b.target}:b}function m(){h(a).then(function(k){d&&a._chunkSize&&!a._finished&&a._file?(c({loaded:a._end,total:a._file&&a._file.size,config:a,type:"progress"}),b.upload(a,!0)):(a._finished&&delete a._finished,n.resolve(k))},function(a){n.reject(a)},function(a){n.notify(a)})}a.method=a.method||"POST";a.headers=a.headers||{};var n=a._deferred=a._deferred||l.defer(),p=n.promise;a.disableProgress||(a.headers.__setXHR_=function(){return function(b){b&&b.upload&&b.upload.addEventListener&&(a.__XHR=b,a.xhrFn&&a.xhrFn(b),b.upload.addEventListener("progress",function(b){b.config=a;c(k(b))},!1),b.upload.addEventListener("load",function(b){b.lengthComputable&&(b.config=a,c(k(b)))},!1))}});d?a._chunkSize&&a._end&&!a._finished?(a._start=a._end,a._end+=a._chunkSize,m()):a.resumeSizeUrl?h.get(a.resumeSizeUrl).then(function(b){a._start=a.resumeSizeResponseReader?a.resumeSizeResponseReader(b.data):parseInt((null==b.data.size?b.data:b.data.size).toString());a._chunkSize&&(a._end=a._start+a._chunkSize);m()},function(a){throw a;}):a.resumeSize?a.resumeSize().then(function(b){a._start=b;m()},function(a){throw a;}):(a._chunkSize&&(a._start=0,a._end=a._start+a._chunkSize),m()):m();p.success=function(b){p.then(function(c){b(c.data,c.status,c.headers,a)});return p};p.error=function(b){p.then(null,function(c){b(c.data,c.status,c.headers,a)});return p};p.progress=function(a){p.progressFunc=a;p.then(null,null,function(b){a(b)});return p};p.abort=p.pause=function(){a.__XHR&&g(function(){a.__XHR.abort()});return p};p.xhr=function(b){a.xhrFn=function(a){return function(){a&&a.apply(p,arguments);b.apply(p,arguments)}}(a.xhrFn);return p};b.promisesCount++;p["finally"](function(){b.promisesCount--});return p}function c(a){var b={},c;for(c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}var b=this;b.promisesCount=0;this.isResumeSupported=function(){return window.Blob&&window.Blob.prototype.slice};var d=this.isResumeSupported();this.isUploadInProgress=function(){return 0<b.promisesCount};this.rename=function(a,b){a.ngfName=b;return a};this.jsonBlob=function(a){null==a||angular.isString(a)||(a=JSON.stringify(a));a=new window.Blob([a],{type:"application/json"});a._ngfBlob=!0;return a};this.json=function(a){return angular.toJson(a)};this.isFile=function(a){return null!=a&&(a instanceof window.Blob||a.flashId&&a.name&&a.size)};this.upload=function(a,f){function k(c,f,m){console.log(f);if(void 0!==f)if(angular.isDate(f)&&(f=f.toISOString()),angular.isString(f))c.append(m,f);else if(b.isFile(f)){if(!f._ngfBlob&&(a._file=a._file||f,null!=a._start&&d)){a._end&&a._end>=f.size&&(a._finished=!0,a._end=f.size);var n=f.slice(a._start,a._end||f.size);n.name=f.name;n.ngfName=f.ngfName;a._chunkSize&&(c.append("_chunkSize",a._chunkSize),c.append("_currentChunkSize",a._end-a._start),c.append("_chunkNumber",Math.floor(a._start/a._chunkSize)),c.append("_totalSize",a._file.size));f=n}n=m.split(",");n[1]&&(f.ngfName=n[1].replace(/^\s+|\s+$/g,""),m=n[0]);a._fileKey=a._fileKey||m;c.append(m,f,f.ngfName||f.name)}else if(angular.isObject(f)){if(f.$$ngfCircularDetection)throw"ngFileUpload: Circular reference in config.data. Make sure specified data for Upload.upload() has no circular reference: "+m;f.$$ngfCircularDetection=!0;try{for(n in f)if(f.hasOwnProperty(n),"$$ngfCircularDetection"!==n){var e=null==a.objectKey?"[i]":a.objectKey;f.length&&-1<parseInt(n)&&(e=null==a.arrayKey?e:a.arrayKey);k(c,f[n],m+e.replace(/[ik]/g,n))}}finally{delete f.$$ngfCircularDetection}}else c.append(m,f)}function m(){a._chunkSize=b.translateScalars(a.resumeChunkSize);a._chunkSize=a._chunkSize?parseInt(a._chunkSize.toString()):null;a.headers=a.headers||{};a.headers["Content-Type"]=void 0;a.transformRequest=a.transformRequest?angular.isArray(a.transformRequest)?a.transformRequest:[a.transformRequest]:[];a.transformRequest.push(function(b){var c=new window.FormData,f;b=b||a.fields||{};a.file&&(b.file=a.file);for(f in b)if(b.hasOwnProperty(f)){var d=b[f];a.formDataAppender?a.formDataAppender(c,f,d):k(c,d,f)}return c})}f||(a=c(a));a._isDigested||(a._isDigested=!0,m());return e(a)};this.http=function(a){a=c(a);a.transformRequest=a.transformRequest||function(a){return window.ArrayBuffer&&a instanceof window.ArrayBuffer||a instanceof window.Blob?a:h.defaults.transformRequest[0].apply(this,arguments)};a._chunkSize=b.translateScalars(a.resumeChunkSize);a._chunkSize=a._chunkSize?parseInt(a._chunkSize.toString()):null;return e(a)};this.translateScalars=function(a){if(angular.isString(a)){if(a.search(/kb/i)===a.length-2)return parseFloat(1024*a.substring(0,a.length-2));if(a.search(/mb/i)===a.length-2)return parseFloat(1048576*a.substring(0,a.length-2));if(a.search(/gb/i)===a.length-2)return parseFloat(1073741824*a.substring(0,a.length-2));if(a.search(/b/i)===a.length-1||a.search(/s/i)===a.length-1)return parseFloat(a.substring(0,a.length-1));if(a.search(/m/i)===a.length-1)return parseFloat(60*a.substring(0,a.length-1));if(a.search(/h/i)===a.length-1)return parseFloat(3600*a.substring(0,a.length-1))}return a};this.urlToBlob=function(a){var b=l.defer();h({url:a,method:"get",responseType:"arraybuffer"}).then(function(a){var c=new Uint8Array(a.data);a=a.headers("content-type")||"image/WebP";c=new window.Blob([c],{type:a});b.resolve(c)},function(a){b.reject(a)});return b.promise};this.setDefaults=function(a){this.defaults=a||{}};this.defaults={};this.version=ngFileUpload.version}]);ngFileUpload.service("Upload",["$parse","$timeout","$compile","$q","UploadExif",function(h,l,g,e,c){function b(a,b,c){var d=[f.emptyPromise()];angular.forEach(a,function(k,n){0===k.type.indexOf("image/jpeg")&&f.attrGetter("ngfFixOrientation",b,c,{$file:k})&&d.push(f.happyPromise(f.applyExifRotation(k),k).then(function(b){a.splice(n,1,b)}))});return e.all(d)}function d(b,c,d){var k=f.attrGetter("ngfResize",c,d);if(!k||!f.isResizeSupported()||!b.length)return f.emptyPromise();if(k instanceof Function){var n=e.defer();k(b).then(function(f){a(f,b,c,d).then(function(a){n.resolve(a)},function(a){n.reject(a)})},function(a){n.reject(a)})}else return a(k,b,c,d)}function a(a,b,c,d){function k(k,m){if(0===k.type.indexOf("image")&&(!a.pattern||f.validatePattern(k,a.pattern))){var e=f.resize(k,a.width,a.height,a.quality,a.type,a.ratio,a.centerCrop,function(a,b){return f.attrGetter("ngfResizeIf",c,d,{$width:a,$height:b,$file:k})},!1!==a.restoreExif);n.push(e);e.then(function(a){b.splice(m,1,a)},function(a){k.$error="resize";k.$errorParam=(a?(a.message?a.message:a)+": ":"")+(k&&k.name)})}}for(var n=[f.emptyPromise()],m=0;m<b.length;m++)k(b[m],m);return e.all(n)}var f=c;f.getAttrWithDefaults=function(a,b){if(null!=a[b])return a[b];a=f.defaults[b];return null==a?a:angular.isString(a)?a:JSON.stringify(a)};f.attrGetter=function(a,b,c,f){b=this.getAttrWithDefaults(b,a);if(c)try{return f?h(b)(c,f):h(b)(c)}catch(v){if(a.search(/min|max|pattern/i))return b;throw v;}else return b};f.shouldUpdateOn=function(a,b,c){return(b=f.attrGetter("ngModelOptions",b,c))&&b.updateOn?-1<b.updateOn.split(" ").indexOf(a):!0};f.emptyPromise=function(){var a=e.defer(),b=arguments;l(function(){a.resolve.apply(a,b)});return a.promise};f.rejectPromise=function(){var a=e.defer(),b=arguments;l(function(){a.reject.apply(a,b)});return a.promise};f.happyPromise=function(a,b){var c=e.defer();a.then(function(a){c.resolve(a)},function(a){l(function(){throw a;});c.resolve(b)});return c.promise};f.updateModel=function(a,c,n,e,g,x,y){function k(b,d,k,g,m){c.$$ngfPrevValidFiles=b;c.$$ngfPrevInvalidFiles=d;var p=b&&b.length?b[0]:null,r=d&&d.length?d[0]:null;a&&(f.applyModelValidation(a,b),a.$setViewValue(m?p:b));e&&h(e)(n,{$files:b,$file:p,$newFiles:k,$duplicateFiles:g,$invalidFiles:d,$invalidFile:r,$event:x});var A=f.attrGetter("ngfModelInvalid",c);A&&l(function(){h(A).assign(n,m?r:d)});l(function(){})}function m(){function a(a,b){return a.name===b.name&&(a.$ngfOrigSize||a.size)===(b.$ngfOrigSize||b.size)&&a.type===b.type}function b(b){var c;for(c=0;c<r.length;c++)if(a(b,r[c]))return!0;for(c=0;c<B.length;c++)if(a(b,B[c]))return!0;return!1}if(g){t=[];u=[];for(var c=0;c<g.length;c++)b(g[c])?u.push(g[c]):t.push(g[c])}}function p(a){return angular.isArray(a)?a:[a]}function v(){q=[];D=[];angular.forEach(t,function(a){a.$error?D.push(a):q.push(a)})}function z(){function b(){l(function(){k(G?r.concat(q):q,G?B.concat(D):D,g,u,J)},F&&F.debounce?F.debounce.change||F.debounce:0)}d(H?t:q,c,n).then(function(){H?f.validate(t,r.length,a,c,n).then(function(){v();b()}):b()},function(a){throw"Could not resize files "+a;})}var t,u=[],r,B,D=[],q=[];r=c.$$ngfPrevValidFiles||[];B=c.$$ngfPrevInvalidFiles||[];a&&a.$modelValue&&(r=p(a.$modelValue));var G=f.attrGetter("ngfKeep",c,n);t=(g||[]).slice(0);"distinct"!==G&&!0!==f.attrGetter("ngfKeepDistinct",c,n)||m(c,n);var J=!G&&!f.attrGetter("ngfMultiple",c,n)&&!f.attrGetter("multiple",c);if(!G||t.length){f.attrGetter("ngfBeforeModelChange",c,n,{$files:g,$file:g&&g.length?g[0]:null,$newFiles:t,$duplicateFiles:u,$event:x});var H=f.attrGetter("ngfValidateAfterResize",c,n),F=f.attrGetter("ngModelOptions",c,n);f.validate(t,r.length,a,c,n).then(function(){y?k(t,[],g,u,J):(F&&F.allowInvalid||H?q=t:v(),f.attrGetter("ngfFixOrientation",c,n)&&f.isExifSupported()?b(q,c,n).then(function(){z()}):z())})}};return f}]);ngFileUpload.directive("ngfSelect",["$parse","$timeout","$compile","Upload",function(h,l,g,e){function c(a){var b=a.match(/Android[^\d]*(\d+)\.(\d+)/);return b&&2<b.length?(a=e.defaults.androidFixMinorVersion||4,4>parseInt(b[1])||parseInt(b[1])===a&&parseInt(b[2])<a):-1===a.indexOf("Chrome")&&/.*Windows.*Safari.*/.test(a)}function b(a,b,k,e,n,g,h,l){function f(){return"input"===b[0].tagName.toLowerCase()&&k.type&&"file"===k.type.toLowerCase()}function p(){return r("ngfChange")||r("ngfSelect")}function m(b){if(l.shouldUpdateOn("change",k,a)){for(var c=b.__files_||b.target&&b.target.files,d=[],f=0;f<c.length;f++)d.push(c[f]);l.updateModel(e,k,a,p(),d.length?d:null,b)}}function v(){if(f())return b;var a=angular.element('\x3cinput type\x3d"file"\x3e');if(b!==a)for(var c=0;c<b[0].attributes.length;c++){var k=b[0].attributes[c];if("type"!==k.name&&"class"!==k.name&&"style"!==k.name){if(null==k.value||""===k.value)"required"===k.name&&(k.value="required"),"multiple"===k.name&&(k.value="multiple");a.attr(k.name,"id"===k.name?"ngf-"+k.value:k.value)}}c=angular.element("\x3clabel\x3eupload\x3c/label\x3e");c.css("visibility","hidden").css("position","absolute").css("overflow","hidden").css("width","0px").css("height","0px").css("border","none").css("margin","0px").css("padding","0px").attr("tabindex","-1");d.push({el:b,ref:c});document.body.appendChild(c.append(a)[0]);return a}function x(k){if(b.attr("disabled"))return!1;if(!r("ngfSelectDisabled",a)){var e=z(k);if(null!=e)return e;t(k);try{f()||document.body.contains(q[0])||(d.push({el:b,ref:q.parent()}),document.body.appendChild(q.parent()[0]),q.bind("change",m))}catch(H){}c(navigator.userAgent)?setTimeout(function(){q[0].click()},0):q[0].click();return!1}}function z(a){var b=a.changedTouches||a.originalEvent&&a.originalEvent.changedTouches;if("touchstart"===a.type)return D=b?b[0].clientY:0,!0;a.stopPropagation();a.preventDefault();if("touchend"===a.type&&20<Math.abs((b?b[0].clientY:0)-D))return!1}function t(b){l.shouldUpdateOn("click",k,a)&&q.val()&&(q.val(null),l.updateModel(e,k,a,p(),null,b,!0))}function u(a){if(q&&!q.attr("__ngf_ie10_Fix_")){if(q[0].parentNode)return a.preventDefault(),a.stopPropagation(),q.unbind("click"),a=q.clone(),q.replaceWith(a),q=a,q.attr("__ngf_ie10_Fix_","true"),q.bind("change",m),q.bind("click",u),q[0].click(),!1;q=null}else q.removeAttr("__ngf_ie10_Fix_")}var r=function(a,b){return l.attrGetter(a,k,b)};l.registerModelChangeValidator(e,k,a);var B=[];B.push(a.$watch(r("ngfMultiple"),function(){q.attr("multiple",r("ngfMultiple",a))}));B.push(a.$watch(r("ngfCapture"),function(){q.attr("capture",r("ngfCapture",a))}));B.push(a.$watch(r("ngfAccept"),function(){q.attr("accept",r("ngfAccept",a))}));k.$observe("accept",function(){q.attr("accept",r("accept"))});B.push(function(){k.$$observers&&delete k.$$observers.accept});var D=0,q=b;f()||(q=v());q.bind("change",m);f()?b.bind("click",t):b.bind("click touchstart touchend",x);-1!==navigator.appVersion.indexOf("MSIE 10")&&q.bind("click",u);e&&e.$formatters.push(function(a){(null==a||0===a.length)&&q.val()&&q.val(null);return a});a.$on("$destroy",function(){f()||q.parent().remove();angular.forEach(B,function(a){a()})});g(function(){for(var a=0;a<d.length;a++){var b=d[a];document.body.contains(b.el[0])||(d.splice(a,1),b.ref.remove())}});window.FileAPI&&window.FileAPI.ngfFixIE&&window.FileAPI.ngfFixIE(b,q,m)}var d=[];return{restrict:"AEC",require:"?ngModel",link:function(a,c,d,m){b(a,c,d,m,h,l,g,e)}}}]);(function(){function h(g){return"img"===g.tagName.toLowerCase()?"image":"audio"===g.tagName.toLowerCase()?"audio":"video"===g.tagName.toLowerCase()?"video":/./}function l(g,e,c,b,d,a,f,k){function m(a){var f=g.attrGetter("ngfNoObjectUrl",d,c);g.dataUrl(a,f)["finally"](function(){e(function(){var c=(f?a.$ngfDataUrl:a.$ngfBlobUrl)||a.$ngfDataUrl;k?b.css("background-image","url('"+(c||"")+"')"):b.attr("src",c);c?b.removeClass("ng-hide"):b.addClass("ng-hide")})})}e(function(){var e=c.$watch(d[a],function(c){var d=f;"ngfThumbnail"===a&&(d||(d={width:b[0].clientWidth,height:b[0].clientHeight}),0===d.width&&window.getComputedStyle&&(d=getComputedStyle(b[0]),d={width:parseInt(d.width.slice(0,-2)),height:parseInt(d.height.slice(0,-2))}));if(angular.isString(c))return b.removeClass("ng-hide"),k?b.css("background-image","url('"+c+"')"):b.attr("src",c);!c||!c.type||0!==c.type.search(h(b[0]))||k&&0!==c.type.indexOf("image")?b.addClass("ng-hide"):d&&g.isResizeSupported()?g.resize(c,d.width,d.height,d.quality).then(function(a){m(a)},function(a){throw a;}):m(c)});c.$on("$destroy",function(){e()})})}ngFileUpload.service("UploadDataUrl",["UploadBase","$timeout","$q",function(g,e,c){g.base64DataUrl=function(b){if(angular.isArray(b)){var d=c.defer(),a=0;angular.forEach(b,function(c){g.dataUrl(c,!0)["finally"](function(){a++;if(a===b.length){var c=[];angular.forEach(b,function(a){c.push(a.$ngfDataUrl)});d.resolve(c,b)}})});return d.promise}return g.dataUrl(b,!0)};g.dataUrl=function(b,d){if(!b)return g.emptyPromise(b,b);if(d&&null!=b.$ngfDataUrl||!d&&null!=b.$ngfBlobUrl)return g.emptyPromise(d?b.$ngfDataUrl:b.$ngfBlobUrl,b);var a=d?b.$$ngfDataUrlPromise:b.$$ngfBlobUrlPromise;if(a)return a;var f=c.defer();e(function(){if(window.FileReader&&b&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 8")||2E4>b.size)&&(!window.FileAPI||-1===navigator.userAgent.indexOf("MSIE 9")||4E6>b.size)){var a=window.URL||window.webkitURL;if(a&&a.createObjectURL&&!d){var c;try{c=a.createObjectURL(b)}catch(p){e(function(){b.$ngfBlobUrl="";f.reject()});return}e(function(){if(b.$ngfBlobUrl=c){f.resolve(c,b);g.blobUrls=g.blobUrls||[];g.blobUrlsTotalSize=g.blobUrlsTotalSize||0;g.blobUrls.push({url:c,size:b.size});g.blobUrlsTotalSize+=b.size||0;for(var d=g.defaults.blobUrlsMaxMemory||268435456,k=g.defaults.blobUrlsMaxQueueSize||200;(g.blobUrlsTotalSize>d||g.blobUrls.length>k)&&1<g.blobUrls.length;){var e=g.blobUrls.splice(0,1)[0];a.revokeObjectURL(e.url);g.blobUrlsTotalSize-=e.size}}})}else{var n=new FileReader;n.onload=function(a){e(function(){b.$ngfDataUrl=a.target.result;f.resolve(a.target.result,b);e(function(){delete b.$ngfDataUrl},1E3)})};n.onerror=function(){e(function(){b.$ngfDataUrl="";f.reject()})};n.readAsDataURL(b)}}else e(function(){b[d?"$ngfDataUrl":"$ngfBlobUrl"]="";f.reject()})});a=d?b.$$ngfDataUrlPromise=f.promise:b.$$ngfBlobUrlPromise=f.promise;a["finally"](function(){delete b[d?"$$ngfDataUrlPromise":"$$ngfBlobUrlPromise"]});return a};return g}]);ngFileUpload.directive("ngfSrc",["Upload","$timeout",function(g,e){return{restrict:"AE",link:function(c,b,d){l(g,e,c,b,d,"ngfSrc",g.attrGetter("ngfResize",d,c),!1)}}}]);ngFileUpload.directive("ngfBackground",["Upload","$timeout",function(g,e){return{restrict:"AE",link:function(c,b,d){l(g,e,c,b,d,"ngfBackground",g.attrGetter("ngfResize",d,c),!0)}}}]);ngFileUpload.directive("ngfThumbnail",["Upload","$timeout",function(g,e){return{restrict:"AE",link:function(c,b,d){var a=g.attrGetter("ngfSize",d,c);l(g,e,c,b,d,"ngfThumbnail",a,g.attrGetter("ngfAsBackground",d,c))}}}]);ngFileUpload.config(["$compileProvider",function(g){g.imgSrcSanitizationWhitelist&&g.imgSrcSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/);g.aHrefSanitizationWhitelist&&g.aHrefSanitizationWhitelist(/^\s*(https?|ftp|mailto|tel|local|file|data|blob):/)}]);ngFileUpload.filter("ngfDataUrl",["UploadDataUrl","$sce",function(g,e){return function(c,b,d){if(angular.isString(c))return e.trustAsResourceUrl(c);var a=c&&((b?c.$ngfDataUrl:c.$ngfBlobUrl)||c.$ngfDataUrl);if(c&&!a)return!c.$ngfDataUrlFilterInProgress&&angular.isObject(c)&&(c.$ngfDataUrlFilterInProgress=!0,g.dataUrl(c,b)),"";c&&delete c.$ngfDataUrlFilterInProgress;return(c&&a?d?e.trustAsResourceUrl(a):a:c)||""}}])})();ngFileUpload.service("UploadValidate",["UploadDataUrl","$q","$timeout",function(h,l,g){function e(b){var c="",a=[];if(2<b.length&&"/"===b[0]&&"/"===b[b.length-1])c=b.substring(1,b.length-1);else{var f=b.split(",");if(1<f.length)for(b=0;b<f.length;b++){var k=e(f[b]);k.regexp?(c+="("+k.regexp+")",b<f.length-1&&(c+="|")):a=a.concat(k.excludes)}else 0===b.indexOf("!")?a.push("^((?!"+e(b.substring(1)).regexp+").)*$"):(0===b.indexOf(".")&&(b="*"+b),c="^"+b.replace(/[.\\+*?\[\^\]$(){}=!<>|:\-]/g,"\\$\x26")+"$",c=c.replace(/\\\*/g,".*").replace(/\\\?/g,"."))}return{regexp:c,excludes:a}}function c(b,c){null==c||b.$dirty||(b.$setDirty?b.$setDirty():b.$dirty=!0)}h.validatePattern=function(b,c){if(!c)return!0;c=e(c);var a=!0;c.regexp&&c.regexp.length&&(a=new RegExp(c.regexp,"i"),a=null!=b.type&&a.test(b.type)||null!=b.name&&a.test(b.name));for(var f=c.excludes.length;f--;)var d=new RegExp(c.excludes[f],"i"),a=a&&(null==b.type||d.test(b.type))&&(null==b.name||d.test(b.name));return a};h.ratioToFloat=function(b){b=b.toString();var c=b.search(/[x:]/i);return b=-1<c?parseFloat(b.substring(0,c))/parseFloat(b.substring(c+1)):parseFloat(b)};h.registerModelChangeValidator=function(b,c,a){b&&b.$formatters.push(function(f){b.$dirty&&(f&&!angular.isArray(f)&&(f=[f]),h.validate(f,0,b,c,a).then(function(){h.applyModelValidation(b,f)}))})};h.applyModelValidation=function(b,d){c(b,d);angular.forEach(b.$ngfValidations,function(a){b.$setValidity(a.name,a.valid)})};h.getValidationAttr=function(b,c,a,f,k){var d="ngf"+a[0].toUpperCase()+a.substr(1),d=h.attrGetter(d,b,c,{$file:k});null==d&&(d=h.attrGetter("ngfValidate",b,c,{$file:k}))&&(b=(f||a).split("."),d=d[b[0]],1<b.length&&(d=d&&d[b[1]]));return d};h.validate=function(b,c,a,f,k){function d(c,d,e){if(b){for(var g=b.length,n=null;g--;){var p=b[g];if(p){var m=h.getValidationAttr(f,k,c,d,p);null==m||e(p,m,g)||(p.$error=c,(p.$errorMessages=p.$errorMessages||{})[c]=!0,p.$errorParam=m,b.splice(g,1),n=!1)}}null!==n&&a.$ngfValidations.push({name:c,valid:n})}}function e(c,d,e,n,p){function m(a,b,d){null!=d?n(b,d).then(function(f){p(f,d)?a.resolve():(b.$error=c,(b.$errorMessages=b.$errorMessages||{})[c]=!0,b.$errorParam=d,a.reject())},function(){g("ngfValidateForce",{$file:b})?(b.$error=c,(b.$errorMessages=b.$errorMessages||{})[c]=!0,b.$errorParam=d,a.reject()):a.resolve()}):a.resolve()}var A=[h.emptyPromise()];if(b)return b=void 0===b.length?[b]:b,angular.forEach(b,function(a){var b=l.defer();A.push(b.promise);!e||null!=a.type&&0===a.type.search(e)?"dimensions"===c&&null!=h.attrGetter("ngfDimensions",f)?h.imageDimensions(a).then(function(c){m(b,a,g("ngfDimensions",{$file:a,$width:c.width,$height:c.height}))},function(){b.reject()}):"duration"===c&&null!=h.attrGetter("ngfDuration",f)?h.mediaDuration(a).then(function(c){m(b,a,g("ngfDuration",{$file:a,$duration:c}))},function(){b.reject()}):m(b,a,h.getValidationAttr(f,k,c,d,a)):b.resolve()}),l.all(A).then(function(){a.$ngfValidations.push({name:c,valid:!0})},function(){a.$ngfValidations.push({name:c,valid:!1})})}a=a||{};a.$ngfValidations=a.$ngfValidations||[];angular.forEach(a.$ngfValidations,function(a){a.valid=!0});var g=function(a,b){return h.attrGetter(a,f,k,b)};if(null==b||0===b.length)return h.emptyPromise(a);b=void 0===b.length?[b]:b.slice(0);d("maxFiles",null,function(a,b,d){return c+d<b});d("pattern",null,h.validatePattern);d("minSize","size.min",function(a,b){return a.size+.1>=h.translateScalars(b)});d("maxSize","size.max",function(a,b){return a.size-.1<=h.translateScalars(b)});var v=0;d("maxTotalSize",null,function(a,c){v+=a.size;return v>h.translateScalars(c)?(b.splice(0,b.length),!1):!0});d("validateFn",null,function(a,b){return!0===b||null===b||""===b});if(!b.length)return h.emptyPromise(a,a.$ngfValidations);var x=l.defer(),y=[];y.push(h.happyPromise(e("maxHeight","height.max",/image/,this.imageDimensions,function(a,b){return a.height<=b})));y.push(h.happyPromise(e("minHeight","height.min",/image/,this.imageDimensions,function(a,b){return a.height>=b})));y.push(h.happyPromise(e("maxWidth","width.max",/image/,this.imageDimensions,function(a,b){return a.width<=b})));y.push(h.happyPromise(e("minWidth","width.min",/image/,this.imageDimensions,function(a,b){return a.width>=b})));y.push(h.happyPromise(e("dimensions",null,/image/,function(a,b){return h.emptyPromise(b)},function(a){return a})));y.push(h.happyPromise(e("ratio",null,/image/,this.imageDimensions,function(a,b){b=b.toString().split(",");for(var c=!1,d=0;d<b.length;d++)1E-4>Math.abs(a.width/a.height-h.ratioToFloat(b[d]))&&(c=!0);return c})));y.push(h.happyPromise(e("maxRatio","ratio.max",/image/,this.imageDimensions,function(a,b){return 1E-4>a.width/a.height-h.ratioToFloat(b)})));y.push(h.happyPromise(e("minRatio","ratio.min",/image/,this.imageDimensions,function(a,b){return-1E-4<a.width/a.height-h.ratioToFloat(b)})));y.push(h.happyPromise(e("maxDuration","duration.max",/audio|video/,this.mediaDuration,function(a,b){return a<=h.translateScalars(b)})));y.push(h.happyPromise(e("minDuration","duration.min",/audio|video/,this.mediaDuration,function(a,b){return a>=h.translateScalars(b)})));y.push(h.happyPromise(e("duration",null,/audio|video/,function(a,b){return h.emptyPromise(b)},function(a){return a})));y.push(h.happyPromise(e("validateAsyncFn",null,null,function(a,b){return b},function(a){return!0===a||null===a||""===a})));return l.all(y).then(function(){x.resolve(a,a.$ngfValidations)})};h.imageDimensions=function(b){if(b.$ngfWidth&&b.$ngfHeight){var c=l.defer();g(function(){c.resolve({width:b.$ngfWidth,height:b.$ngfHeight})});return c.promise}if(b.$ngfDimensionPromise)return b.$ngfDimensionPromise;var a=l.defer();g(function(){0!==b.type.indexOf("image")?a.reject("not image"):h.dataUrl(b).then(function(c){function d(){var c=e[0].clientWidth,d=e[0].clientHeight;e.remove();b.$ngfWidth=c;b.$ngfHeight=d;a.resolve({width:c,height:d})}function f(){g(function(){e[0].parentNode&&(e[0].clientWidth?d():f())},1E3)}var e=angular.element("\x3cimg\x3e").attr("src",c).css("visibility","hidden").css("position","fixed").css("max-width","none !important").css("max-height","none !important");e.on("load",d);e.on("error",function(){e.remove();a.reject("load error")});f();angular.element(document.getElementsByTagName("body")[0]).append(e)},function(){a.reject("load error")})});b.$ngfDimensionPromise=a.promise;b.$ngfDimensionPromise["finally"](function(){delete b.$ngfDimensionPromise});return b.$ngfDimensionPromise};h.mediaDuration=function(b){if(b.$ngfDuration){var c=l.defer();g(function(){c.resolve(b.$ngfDuration)});return c.promise}if(b.$ngfDurationPromise)return b.$ngfDurationPromise;var a=l.defer();g(function(){0!==b.type.indexOf("audio")&&0!==b.type.indexOf("video")?a.reject("not media"):h.dataUrl(b).then(function(c){function d(){var c=e[0].duration;b.$ngfDuration=c;e.remove();a.resolve(c)}function f(){g(function(){e[0].parentNode&&(e[0].duration?d():f())},1E3)}var e=angular.element(0===b.type.indexOf("audio")?"\x3caudio\x3e":"\x3cvideo\x3e").attr("src",c).css("visibility","none").css("position","fixed");e.on("loadedmetadata",d);e.on("error",function(){e.remove();a.reject("load error")});f();angular.element(document.body).append(e)},function(){a.reject("load error")})});b.$ngfDurationPromise=a.promise;b.$ngfDurationPromise["finally"](function(){delete b.$ngfDurationPromise});return b.$ngfDurationPromise};return h}]);ngFileUpload.service("UploadResize",["UploadValidate","$q",function(h,l){var g=function(e,c,b,d,a,f,k,g){var n=l.defer(),p=document.createElement("canvas"),m=document.createElement("img");m.onload=function(){var e,l,v,E;if(null!=g&&!1===g(m.width,m.height))n.reject("resizeIf");else try{if(f){var w=h.ratioToFloat(f);m.width/m.height<w?(c=m.width,b=c/w):(b=m.height,c=b*w)}c||(c=m.width);b||(b=m.height);var C=m.width,z=m.height,t=k?Math.max(c/C,b/z):Math.min(c/C,b/z);e=C*t;l=z*t;v=C*t-c;E=z*t-b;p.width=Math.min(e,c);p.height=Math.min(l,b);p.getContext("2d").drawImage(m,Math.min(0,-v/2),Math.min(0,-E/2),e,l);n.resolve(p.toDataURL(a||"image/WebP",d||.934))}catch(u){n.reject(u)}};m.onerror=function(){n.reject()};m.src=e;return n.promise};h.dataUrltoBlob=function(e,c,b){var d=e.split(",");e=d[0].match(/:(.*?);/)[1];for(var d=atob(d[1]),a=d.length,f=new Uint8Array(a);a--;)f[a]=d.charCodeAt(a);e=new window.Blob([f],{type:e});e.name=c;e.$ngfOrigSize=b;return e};h.isResizeSupported=function(){var e=document.createElement("canvas");return window.atob&&e.getContext&&e.getContext("2d")&&window.Blob};h.isResizeSupported()&&Object.defineProperty(window.Blob.prototype,"name",{get:function(){return this.$ngfName},set:function(e){this.$ngfName=e},configurable:!0});h.resize=function(e,c,b,d,a,f,k,m,n){if(0!==e.type.indexOf("image"))return h.emptyPromise(e);var p=l.defer();h.dataUrl(e,!0).then(function(l){g(l,c,b,d,a||e.type,f,k,m).then(function(a){if("image/jpeg"===e.type&&n)try{a=h.restoreExif(l,a)}catch(A){setTimeout(function(){throw A;},1)}try{var b=h.dataUrltoBlob(a,e.name,e.size);p.resolve(b)}catch(A){p.reject(A)}},function(a){"resizeIf"===a&&p.resolve(e);p.reject(a)})},function(a){p.reject(a)});return p.promise};return h}]);(function(){function h(g,e,c,b,d,a,f,k,h,n){function m(){return e.attr("disabled")||w("ngfDropDisabled",g)}function v(a,d){k.updateModel(b,c,g,w("ngfChange")||w("ngfDrop"),a,d)}function x(a,b){if(!k.shouldUpdateOn(a,c,g)||!b)return k.rejectPromise([]);var d=[];b.replace(/<(img src|img [^>]* src) *=\"([^\"]*)\"/gi,function(a,b,c){d.push(c)});var f=[],e=[];if(d.length){angular.forEach(d,function(a){f.push(k.urlToBlob(a).then(function(a){e.push(a)}))});var h=n.defer();n.all(f).then(function(){h.resolve(e)},function(a){h.reject(a)});return h.promise}return k.emptyPromise()}function y(a,b,c,d){b=w("ngfDragOverClass",a,{$event:c});var f="dragover";if(angular.isString(b))f=b;else if(b&&(b.delay&&(t=b.delay),b.accept||b.reject)){var e=c.dataTransfer.items;if(null!=e&&e.length)for(a=b.pattern||w("ngfPattern",a,{$event:c}),c=e.length;c--;)if(k.validatePattern(e[c],a))f=b.accept;else{f=b.reject;break}else f=b.accept}d(f)}function A(a,b,d,e){function h(a,b){var c=n.defer();if(null!=a)if(a.isDirectory){var d=[k.emptyPromise()];if(l){var f={type:"directory"};f.name=f.path=(b||"")+a.name+a.name;r.push(f)}var e=a.createReader(),g=[],v=function(){e.readEntries(function(f){try{f.length?(g=g.concat(Array.prototype.slice.call(f||[],0)),v()):(angular.forEach(g.slice(0),function(c){r.length<=m&&q<=p&&d.push(h(c,(b?b:"")+a.name+"/"))}),n.all(d).then(function(){c.resolve()},function(a){c.reject(a)}))}catch(I){c.reject(I)}},function(a){c.reject(a)})};v()}else a.file(function(a){try{a.path=(b?b:"")+a.name,l&&(a=k.rename(a,a.path)),r.push(a),q+=a.size,c.resolve()}catch(I){c.reject(I)}},function(a){c.reject(a)});return c.promise}var m=k.getValidationAttr(c,g,"maxFiles")||Number.MAX_VALUE,p=k.getValidationAttr(c,g,"maxTotalSize")||Number.MAX_VALUE,l=w("ngfIncludeDir",g),r=[],q=0,v=[k.emptyPromise()];if(a&&0<a.length&&"file"!==f.protocol())for(b=0;b<a.length;b++){if(a[b].webkitGetAsEntry&&a[b].webkitGetAsEntry()&&a[b].webkitGetAsEntry().isDirectory){var t=a[b].webkitGetAsEntry();if(t.isDirectory&&!d)continue;null!=t&&v.push(h(t))}else t=a[b].getAsFile(),null!=t&&(r.push(t),q+=t.size);if(r.length>m||q>p||!e&&0<r.length)break}else if(null!=b)for(a=0;a<b.length;a++){d=b.item(a);if(d.type||0<d.size)r.push(d),q+=d.size;if(r.length>m||q>p||!e&&0<r.length)break}var u=n.defer();n.all(v).then(function(){if(e||l||!r.length)u.resolve(r);else{for(var a=0;r[a]&&"directory"===r[a].type;)a++;u.resolve([r[a]])}},function(a){u.reject(a)});return u.promise}var E=l(),w=function(a,b,d){return k.attrGetter(a,c,b,d)};w("dropAvailable")&&a(function(){g[w("dropAvailable")]?g[w("dropAvailable")].value=E:g[w("dropAvailable")]=E});if(E){null==w("ngfSelect")&&k.registerModelChangeValidator(b,c,g);var C=null,z=d(w("ngfStopPropagation")),t=1,u;e[0].addEventListener("dragover",function(b){if(!m()&&k.shouldUpdateOn("drop",c,g)){b.preventDefault();z(g)&&b.stopPropagation();if(-1<navigator.userAgent.indexOf("Chrome")){var d=b.dataTransfer.effectAllowed;b.dataTransfer.dropEffect="move"===d||"linkMove"===d?"move":"copy"}a.cancel(C);u||(u="C",y(g,c,b,function(a){u=a;e.addClass(u);w("ngfDrag",g,{$isDragging:!0,$class:u,$event:b})}))}},!1);e[0].addEventListener("dragenter",function(a){!m()&&k.shouldUpdateOn("drop",c,g)&&(a.preventDefault(),z(g)&&a.stopPropagation())},!1);e[0].addEventListener("dragleave",function(b){!m()&&k.shouldUpdateOn("drop",c,g)&&(b.preventDefault(),z(g)&&b.stopPropagation(),C=a(function(){u&&e.removeClass(u);u=null;w("ngfDrag",g,{$isDragging:!1,$event:b})},t||100))},!1);e[0].addEventListener("drop",function(a){if(!m()&&k.shouldUpdateOn("drop",c,g)){a.preventDefault();z(g)&&a.stopPropagation();u&&e.removeClass(u);u=null;var b=a.dataTransfer.items,d;try{d=a.dataTransfer&&a.dataTransfer.getData&&a.dataTransfer.getData("text/html")}catch(q){}A(b,a.dataTransfer.files,!1!==w("ngfAllowDir",g),w("multiple")||w("ngfMultiple",g)).then(function(b){b.length?v(b,a):x("dropUrl",d).then(function(b){v(b,a)})})}},!1);e[0].addEventListener("paste",function(a){-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&w("ngfEnableFirefoxPaste",g)&&a.preventDefault();if(!m()&&k.shouldUpdateOn("paste",c,g)){var b=[],d=a.clipboardData||a.originalEvent.clipboardData;if(d&&d.items)for(var f=0;f<d.items.length;f++)-1!==d.items[f].type.indexOf("image")&&b.push(d.items[f].getAsFile());b.length?v(b,a):x("pasteUrl",d).then(function(b){v(b,a)})}},!1);-1<navigator.userAgent.toLowerCase().indexOf("firefox")&&w("ngfEnableFirefoxPaste",g)&&(e.attr("contenteditable",!0),e.on("keypress",function(a){a.metaKey||a.ctrlKey||a.preventDefault()}))}else!0===w("ngfHideOnDropNotAvailable",g)&&e.css("display","none")}function l(){var g=document.createElement("div");return"draggable"in g&&"ondrop"in g&&!/Edge\/12./i.test(navigator.userAgent)}ngFileUpload.directive("ngfDrop",["$parse","$timeout","$location","Upload","$http","$q",function(g,e,c,b,d,a){return{restrict:"AEC",require:"?ngModel",link:function(f,k,m,n){h(f,k,m,n,g,e,c,b,d,a)}}}]);ngFileUpload.directive("ngfNoFileDrop",function(){return function(g,e){l()&&e.css("display","none")}});ngFileUpload.directive("ngfDropAvailable",["$parse","$timeout","Upload",function(g,e,c){return function(b,d,a){if(l()){var f=g(c.attrGetter("ngfDropAvailable",a));e(function(){f(b);f.assign&&f.assign(b,!0)})}}}])})();ngFileUpload.service("UploadExif",["UploadResize","$q",function(h,l){function g(c,b,d,a){switch(b){case 2:return c.transform(-1,0,0,1,d,0);case 3:return c.transform(-1,0,0,-1,d,a);case 4:return c.transform(1,0,0,-1,0,a);case 5:return c.transform(0,1,1,0,0,0);case 6:return c.transform(0,1,-1,0,a,0);case 7:return c.transform(0,-1,-1,0,a,d);case 8:return c.transform(0,-1,1,0,0,d)}}function e(c){var b="";c=new Uint8Array(c);for(var d=c.byteLength,a=0;a<d;a++)b+=String.fromCharCode(c[a]);return window.btoa(b)}h.isExifSupported=function(){return window.FileReader&&(new FileReader).readAsArrayBuffer&&h.isResizeSupported()};h.readOrientation=function(c){var b=l.defer(),d=new FileReader;c=c.slice?c.slice(0,65536):c;d.readAsArrayBuffer(c);d.onerror=function(a){return b.reject(a)};d.onload=function(a){var c={orientation:1},d=new DataView(this.result);if(65496!==d.getUint16(0,!1))return b.resolve(c);for(var e=d.byteLength,g=2;g<e;){var h=d.getUint16(g,!1),g=g+2;if(65505===h){if(1165519206!==d.getUint32(g+=2,!1))break;for(var h=18761===d.getUint16(g+=6,!1),g=g+d.getUint32(g+4,h),l=d.getUint16(g,h),g=g+2,x=0;x<l;x++)if(274===d.getUint16(g+12*x,h))return e=d.getUint16(g+12*x+8,h),2<=e&&8>=e&&(d.setUint16(g+12*x+8,1,h),c.fixedArrayBuffer=a.target.result),c.orientation=e,b.resolve(c)}else if(65280!==(h&65280))break;else g+=d.getUint16(g,!1)}return b.resolve(c)};return b.promise};h.applyExifRotation=function(c){if(0!==c.type.indexOf("image/jpeg"))return h.emptyPromise(c);var b=l.defer();h.readOrientation(c).then(function(d){if(2>d.orientation||8<d.orientation)return b.resolve(c);h.dataUrl(c,!0).then(function(a){var f=document.createElement("canvas"),k=document.createElement("img");k.onload=function(){try{f.width=4<d.orientation?k.height:k.width;f.height=4<d.orientation?k.width:k.height;var a=f.getContext("2d");g(a,d.orientation,k.width,k.height);a.drawImage(k,0,0);var n=f.toDataURL(c.type||"image/WebP",.934),n=h.restoreExif(e(d.fixedArrayBuffer),n),l=h.dataUrltoBlob(n,c.name);b.resolve(l)}catch(v){return b.reject(v)}};k.onerror=function(){b.reject()};k.src=a},function(a){b.reject(a)})},function(c){b.reject(c)});return b.promise};h.restoreExif=function(c,b){return{KEY_STR:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\x3d",encode64:function(b){var a="",c,d,e,g,h,l,x=0;do c=b[x++],d=b[x++],e=b[x++],g=c>>2,c=(c&3)<<4|d>>4,h=(d&15)<<2|e>>6,l=e&63,isNaN(d)?h=l=64:isNaN(e)&&(l=64),a=a+this.KEY_STR.charAt(g)+this.KEY_STR.charAt(c)+this.KEY_STR.charAt(h)+this.KEY_STR.charAt(l);while(x<b.length);return a},restore:function(b,a){b.match("data:image/jpeg;base64,")&&(b=b.replace("data:image/jpeg;base64,",""));b=this.decode64(b);b=this.slice2Segments(b);a=this.exifManipulation(a,b);return"data:image/jpeg;base64,"+this.encode64(a)},exifManipulation:function(b,a){a=this.getExifArray(a);b=this.insertExif(b,a);return new Uint8Array(b)},getExifArray:function(b){for(var a,c=0;c<b.length;c++)if(a=b[c],255===a[0]&225===a[1])return a;return[]},insertExif:function(b,a){b=b.replace("data:image/jpeg;base64,","");var c=this.decode64(b),d=c.indexOf(255,3);b=c.slice(0,d);c=c.slice(d);a=b.concat(a);return a=a.concat(c)},slice2Segments:function(b){for(var a=0,c=[];!(255===b[a]&218===b[a+1]);){if(255===b[a]&216===b[a+1])a+=2;else{var d=a+(256*b[a+2]+b[a+3])+2,a=b.slice(a,d);c.push(a);a=d}if(a>b.length)break}return c},decode64:function(b){var a,c,d,e,g,h=0,l=[];/[^A-Za-z0-9\+\/\=]/g.exec(b)&&console.log("There were invalid base64 characters in the input text.\nValid base64 characters are A-Z, a-z, 0-9, NaNExpect errors in decoding.");b=b.replace(/[^A-Za-z0-9\+\/\=]/g,"");do a=this.KEY_STR.indexOf(b.charAt(h++)),c=this.KEY_STR.indexOf(b.charAt(h++)),e=this.KEY_STR.indexOf(b.charAt(h++)),g=this.KEY_STR.indexOf(b.charAt(h++)),a=a<<2|c>>4,c=(c&15)<<4|e>>2,d=(e&3)<<6|g,l.push(a),64!==e&&l.push(c),64!==g&&l.push(d);while(h<b.length);return l}}.restore(c,b)};return h}]);
/*# sourceMappingURL=ng-file-upload-all.min.js.map */